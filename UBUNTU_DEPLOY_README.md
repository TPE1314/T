# Ubuntu ä¸€é”®éƒ¨ç½²å®‰è£…è„šæœ¬ä½¿ç”¨è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®æä¾›äº†ä¸¤ä¸ªUbuntuéƒ¨ç½²è„šæœ¬ï¼Œç”¨äºåœ¨Ubuntuç³»ç»Ÿä¸Šå¿«é€Ÿéƒ¨ç½²Telegram BotæœåŠ¡ï¼š

1. **`ubuntu_deploy.sh`** - å®Œæ•´ç‰ˆéƒ¨ç½²è„šæœ¬ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰
2. **`quick_deploy.sh`** - å¿«é€Ÿéƒ¨ç½²è„šæœ¬ï¼ˆé€‚åˆå¼€å‘æµ‹è¯•ï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Ubuntu 18.04 æˆ–æ›´é«˜ç‰ˆæœ¬
- æ™®é€šç”¨æˆ·è´¦æˆ·ï¼ˆérootç”¨æˆ·ï¼‰
- ç½‘ç»œè¿æ¥
- sudoæƒé™

### æ–¹æ³•1ï¼šå¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
# ä¸‹è½½è„šæœ¬
wget https://raw.githubusercontent.com/your-repo/your-project/main/quick_deploy.sh

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x quick_deploy.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./quick_deploy.sh
```

### æ–¹æ³•2ï¼šå®Œæ•´éƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

```bash
# ä¸‹è½½è„šæœ¬
wget https://raw.githubusercontent.com/your-repo/your-project/main/ubuntu_deploy.sh

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x ubuntu_deploy.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./ubuntu_deploy.sh
```

## ğŸ”§ è„šæœ¬åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | å¿«é€Ÿéƒ¨ç½² | å®Œæ•´éƒ¨ç½² |
|------|----------|----------|
| ç³»ç»Ÿä¾èµ–å®‰è£… | âœ… åŸºç¡€ | âœ… å®Œæ•´ |
| Pythonç¯å¢ƒ | âœ… åŸºç¡€ | âœ… å®Œæ•´ |
| Redis | âœ… | âœ… |
| Nginx | âœ… åŸºç¡€ | âœ… å®Œæ•´é…ç½® |
| MySQL | âŒ | âœ… å¯é€‰ |
| MongoDB | âŒ | âœ… å¯é€‰ |
| Docker | âŒ | âœ… å¯é€‰ |
| ç³»ç»ŸæœåŠ¡ | âœ… | âœ… |
| é˜²ç«å¢™é…ç½® | âœ… åŸºç¡€ | âœ… å®Œæ•´ |
| æ—¥å¿—è½®è½¬ | âŒ | âœ… |
| å¤‡ä»½è„šæœ¬ | âŒ | âœ… |
| ç›‘æ§è„šæœ¬ | âŒ | âœ… |
| å®‰å…¨é…ç½® | âŒ | âœ… |

## ğŸ“ éƒ¨ç½²åçš„ç›®å½•ç»“æ„

```
/home/ç”¨æˆ·å/telegram-bot/
â”œâ”€â”€ app/                    # åº”ç”¨ä»£ç 
â”œâ”€â”€ static/                 # é™æ€æ–‡ä»¶
â”œâ”€â”€ uploads/                # ä¸Šä¼ æ–‡ä»¶
â”œâ”€â”€ data/                   # æ•°æ®æ–‡ä»¶
â”œâ”€â”€ logs/                   # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ backups/                # å¤‡ä»½æ–‡ä»¶
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ ssl/                    # SSLè¯ä¹¦
â”œâ”€â”€ venv/                   # Pythonè™šæ‹Ÿç¯å¢ƒ
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ bot.py                  # ä¸»ç¨‹åº
â”œâ”€â”€ start_bot.sh           # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ backup.sh              # å¤‡ä»½è„šæœ¬ï¼ˆå®Œæ•´ç‰ˆï¼‰
â””â”€â”€ monitor.sh             # ç›‘æ§è„šæœ¬ï¼ˆå®Œæ•´ç‰ˆï¼‰
```

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

### æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status telegram-bot

# å¯åŠ¨æœåŠ¡
sudo systemctl start telegram-bot

# åœæ­¢æœåŠ¡
sudo systemctl stop telegram-bot

# é‡å¯æœåŠ¡
sudo systemctl restart telegram-bot

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u telegram-bot -f
```

### å…¶ä»–æœåŠ¡

```bash
# RedisçŠ¶æ€
sudo systemctl status redis-server

# NginxçŠ¶æ€
sudo systemctl status nginx

# é˜²ç«å¢™çŠ¶æ€
sudo ufw status
```

## âš™ï¸ é…ç½®è¯´æ˜

### 1. ç¯å¢ƒå˜é‡é…ç½®

éƒ¨ç½²å®Œæˆåï¼Œéœ€è¦é…ç½® `.env` æ–‡ä»¶ï¼š

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano /home/ç”¨æˆ·å/telegram-bot/.env

# ä¸»è¦é…ç½®é¡¹
BOT_TOKEN=your_bot_token_here
ADMIN_IDS=123456789,987654321
SUPER_ADMIN_ID=123456789
```

### 2. Boté…ç½®

ç¼–è¾‘ `config.py` æ–‡ä»¶ï¼š

```python
# æ•°æ®åº“é…ç½®
DATABASE_URL = "sqlite:///data/bot.db"

# Redisé…ç½®
REDIS_URL = "redis://localhost:6379/0"

# å…¶ä»–é…ç½®...
```

### 3. Nginxé…ç½®ï¼ˆå®Œæ•´ç‰ˆï¼‰

å®Œæ•´ç‰ˆä¼šè‡ªåŠ¨é…ç½®Nginxï¼ŒåŒ…æ‹¬ï¼š
- åå‘ä»£ç†åˆ°Bot API
- é™æ€æ–‡ä»¶æœåŠ¡
- ä¸Šä¼ æ–‡ä»¶æœåŠ¡
- å¥åº·æ£€æŸ¥ç«¯ç‚¹

## ğŸ”’ å®‰å…¨é…ç½®

### é˜²ç«å¢™è§„åˆ™

è„šæœ¬ä¼šè‡ªåŠ¨é…ç½®UFWé˜²ç«å¢™ï¼š
- å…è®¸SSHè¿æ¥
- å…è®¸HTTP/HTTPS
- å…è®¸Bot APIç«¯å£
- é»˜è®¤æ‹’ç»å…¥ç«™è¿æ¥

### æœåŠ¡ç”¨æˆ·

å®Œæ•´ç‰ˆä¼šåˆ›å»ºä¸“ç”¨çš„æœåŠ¡ç”¨æˆ· `botuser`ï¼Œæé«˜å®‰å…¨æ€§ã€‚

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### è‡ªåŠ¨å¤‡ä»½

å®Œæ•´ç‰ˆåŒ…å«è‡ªåŠ¨å¤‡ä»½åŠŸèƒ½ï¼š
- æ¯æ—¥å‡Œæ™¨2ç‚¹è‡ªåŠ¨å¤‡ä»½
- ä¿ç•™æœ€è¿‘30å¤©çš„å¤‡ä»½
- å¤‡ä»½æ•°æ®ã€ä¸Šä¼ æ–‡ä»¶ã€æ—¥å¿—ç­‰

### ç³»ç»Ÿç›‘æ§

å®Œæ•´ç‰ˆåŒ…å«ç›‘æ§è„šæœ¬ï¼š
- æ¯5åˆ†é’Ÿæ£€æŸ¥æœåŠ¡çŠ¶æ€
- ç›‘æ§ç£ç›˜å’Œå†…å­˜ä½¿ç”¨
- è‡ªåŠ¨é‡å¯å¤±è´¥çš„æœåŠ¡

### æ—¥å¿—ç®¡ç†

- è‡ªåŠ¨æ—¥å¿—è½®è½¬
- æ—¥å¿—å‹ç¼©å’Œæ¸…ç†
- ç³»ç»Ÿæ—¥å¿—é›†æˆ

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
   sudo journalctl -u telegram-bot -n 50
   
   # æ£€æŸ¥é…ç½®æ–‡ä»¶
   sudo systemctl status telegram-bot
   ```

2. **æƒé™é—®é¢˜**
   ```bash
   # ä¿®å¤æ–‡ä»¶æƒé™
   sudo chown -R ç”¨æˆ·å:ç”¨æˆ·å /home/ç”¨æˆ·å/telegram-bot/
   sudo chmod -R 755 /home/ç”¨æˆ·å/telegram-bot/
   ```

3. **ç«¯å£å†²çª**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   sudo netstat -tlnp | grep :8443
   sudo netstat -tlnp | grep :80
   ```

4. **Redisè¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥RedisçŠ¶æ€
   sudo systemctl status redis-server
   
   # æµ‹è¯•Redisè¿æ¥
   redis-cli ping
   ```

### æ—¥å¿—ä½ç½®

- åº”ç”¨æ—¥å¿—ï¼š`/home/ç”¨æˆ·å/telegram-bot/logs/`
- ç³»ç»Ÿæ—¥å¿—ï¼š`/var/log/syslog`
- Nginxæ—¥å¿—ï¼š`/var/log/nginx/`
- Redisæ—¥å¿—ï¼š`/var/log/redis/`

## ğŸ”„ æ›´æ–°å’Œå‡çº§

### æ›´æ–°ä»£ç 

```bash
cd /home/ç”¨æˆ·å/telegram-bot/
git pull origin main
sudo systemctl restart telegram-bot
```

### æ›´æ–°ä¾èµ–

```bash
cd /home/ç”¨æˆ·å/telegram-bot/
source venv/bin/activate
pip install -r requirements.txt --upgrade
sudo systemctl restart telegram-bot
```

### ç³»ç»Ÿå‡çº§

```bash
sudo apt update && sudo apt upgrade -y
sudo systemctl restart telegram-bot
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
2. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
3. ç¡®è®¤é…ç½®æ–‡ä»¶æ­£ç¡®
4. æ£€æŸ¥ç½‘ç»œè¿æ¥
5. æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ

## ğŸ“ æ›´æ–°æ—¥å¿—

- **v1.0.0** - åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€éƒ¨ç½²
- **v1.1.0** - æ·»åŠ å®Œæ•´ç‰ˆéƒ¨ç½²è„šæœ¬
- **v1.2.0** - å¢å¼ºå®‰å…¨é…ç½®å’Œç›‘æ§åŠŸèƒ½

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¸è¦ä½¿ç”¨rootç”¨æˆ·è¿è¡Œè„šæœ¬**
2. **ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨å®Œæ•´ç‰ˆè„šæœ¬**
3. **å®šæœŸå¤‡ä»½é‡è¦æ•°æ®**
4. **åŠæ—¶æ›´æ–°ç³»ç»Ÿå’Œä¾èµ–**
5. **ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ**
6. **é…ç½®SSLè¯ä¹¦ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰**

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ LICENSE æ–‡ä»¶ã€‚